{% extends 'base.html' %}
{% load static %}
{% block content %}

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

<style>
    select:focus {
        outline: none !important;
        box-shadow: none !important;
    }

    #customer_sel option:hover {
        background-color: rgb(210, 132, 30);
    }

    .element-below-fixed {
        padding-top: 100px;
    }

    /* width */
    ::-webkit-scrollbar {
        width: 10px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    /* Handle */
    ::-webkit-scrollbar-thumb {
        background: #888;
    }

    /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
        background: #555;
    }

    .hide {
        display: none;
    }
    .modal{
      z-index: 9999;
      overflow: scroll;
    }
</style>

<script>



function calc() {
    var x=document.getElementById("cus_place").value
    var y=document.getElementById("state").value
    if ( x == y )
    {
        $('#item_table tbody tr').each(function () {
            var html = $(this).html();
            if (html != '') {
                console.log('rows');
                var qty = $(this).find('.qty').val();
                var rate = $(this).find('.rate').val();
                var discount = $(this).find('.discount').val();
                var tax = $(this).find('.tax').val();
                console.log(qty);
                console.log(rate);
                console.log(discount);
                console.log(tax);
                $(this).find('.taxamount').val((qty * rate) * (tax / 100));
                var taxamount = parseFloat($(this).find('.taxamount').val());
                $(this).find('.amount').val(qty * rate - discount);

                calc_total();
           
            }
        });
       }
       if ( x != y )
       {
        $('#item_tablee tbody tr').each(function () {

        var html = $(this).html();
      if (html != '') {
    

    console.log('rows');
    var qtyy = $(this).find('.qtyy').val();
    var ratee = $(this).find('.ratee').val();
    var discountt = $(this).find('.discountt').val();
    var taxx= $(this).find('.taxx').val();
    console.log(qtyy);
    console.log(ratee);
    console.log(discountt);
    console.log(taxx);
    $(this).find('.taxamountt').val((qtyy * ratee) * (taxx / 100));
    var taxamountt = parseFloat($(this).find('.taxamountt').val());
    $(this).find('.amountt').val(qtyy * ratee - discountt);

    calc_total();
   }
});
    }
}
    function calc_total() {
        var x=document.getElementById("cus_place").value
        var y=document.getElementById("state").value
        if ( x == y )
        {
        total = 0;
        $('.amount').each(function () {
            total += parseFloat($(this).val()) ;
            
        });
        taxamount = 0;
        $('.taxamount').each(function () {
            taxamount += parseFloat($(this).val()) ;

        });
       
       
        $('#subtotal').val(total.toFixed(2));
        $('#total_taxamount').val(taxamount.toFixed(2));

        $('#total').val((taxamount + total).toFixed(2));

        test();
       }
       else
       {
        total = 0;
        $('.amountt').each(function () {
            total += parseFloat($(this).val()) ;
            
        });
        taxamount = 0;
        $('.taxamountt').each(function () {
            taxamount += parseFloat($(this).val()) ;

        });
       
       
        $('#subtotal').val(total.toFixed(2));
        $('#total_taxamount').val(taxamount.toFixed(2));

        $('#total').val((taxamount + total).toFixed(2));

        test();
       }
    }

    function test() {
        console.log('test');
        d = 0;
        var pos = $("#customer_sel option:selected").data("pos");
        var state = document.getElementById("state").value;

        if (pos == state) {
            console.log(pos);
            console.log(state);
            console.log(taxamount);
            gst = taxamount / 2;
            // gst = Math.round (gst);
            console.log(gst);
            $('#cgst').val(parseFloat(gst.toFixed(2)));
            $('#sgst').val(parseFloat(gst.toFixed(2)));
            $('#igst').val(parseFloat(d.toFixed(2)));
            document.getElementById("tr_cgst").style.display = "table-row";
            document.getElementById("tr_sgst").style.display = "table-row";


        }
        if (pos != state) {
            // else{
            console.log(pos);
            console.log(state);
            $('#igst').val(taxamount.toFixed(2));
            $('#cgst').val(d.toFixed(2));
            $('#sgst').val(d.toFixed(2));
            document.getElementById('tr_igst').style.display = "table-row";
            // document.getElementById('tr_cgst').style.display = "table-row";
            // document.getElementById('tr_sgst').style.display = "table-row";

        }
    }  
    // Calculate total
    $(document).ready(function () {
        $('#shipping, #adjustment').on('keyup', function () {
            var shipping_charge = parseFloat($('#shipping').val() || 0);
            var adjustment_charge = parseFloat($('#adjustment').val() || 0);
            var subtotal = parseFloat($('#subtotal').val() || 0);
            var total_tax = parseFloat($('#total_taxamount').val() || 0);
            var total = subtotal + total_tax + shipping_charge + adjustment_charge;
            // total = Math.round(total);

            $('#shipping_charge').val(shipping_charge.toFixed(2));
            $('#adjustment_charge').val(adjustment_charge.toFixed(2));
            $('#total').val(total.toFixed(2));
        });
    });

</script>

<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script>

    function cancelDialog() {

        var frm = document.getElementById("forms");
        let customMsg = "Are you sure you want to cancel?";

        if (confirm(customMsg)) {
            alert("adjustment cancelled!")
        }
    }

    function saveAsDraftDialog() {

        var frm = document.getElementById("forms");
        frm.action = ("{% url 'createestimate'%}")
    }

    // function get_customer_email() {

    //  var eml = document.getElementById("customer_sel");
    //  eml.action = ("{% url 'newestimate'%}")
    // }

    function saveAndSendDialog() {

        var frm = document.getElementById("forms");
        frm.action = ("{% url 'create_and_send_estimate'%}")
    }
    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });



</script>

<!-- <script>
    function cust_mail(){
        var name= document.getElementById("customer_sel").value
        var customer = name.split(' ')[0];
        var table = document.getElementById("item_table");
        var RowCount = table.rows.length;

        
        $.ajax({
                type: "GET",
                url: "{% url 'get_cust_mail' %}",
                data: {
                 
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.email
                    data1=response.cust_id
                    data2=response.cust_place_supply
                    document.getElementById("customer_mail").value = data
                    document.getElementById("customer_id").value=data1
                    document.getElementById("cus_place").value=data2

                    var x=document.getElementById("cus_place").value
                    var y=document.getElementById("state").value
                                if ( x == y )
                                {
                                   document.getElementById("item_table").style.display="block"
                                   document.getElementById("item_tablee").style.display="none"
                                   document.getElementById("label_tab1").style.display="block"
                                   document.getElementById("label_tab2").style.display="none"
                                   document.getElementById("add-row").style.display="block"
                                   document.getElementById("add-roww").style.display="none"


                                    
                        
                                }
                                else
                                {
                                   document.getElementById("item_table").style.display="none"
                                   document.getElementById("item_tablee").style.display="block"
                                   document.getElementById("label_tab1").style.display="none"
                                   document.getElementById("label_tab2").style.display="block"
                                   document.getElementById("add-row").style.display="none"
                                   document.getElementById("add-roww").style.display="block"
                                    
                                    
                                }
                    
                    
                }
            });
                                
    }
</script> -->


<section>
    <div  style="top: 7rem;">
        <div class="row  ml-2" >
            <div class="col-md-3 "><a class="text-white" style="font-size: 1.8rem;">New
                    Adjustment</a></div>
    

        </div>
         <div></div>
            <form method="POST" action="" class="p-5" enctype="multipart/form-data" novalidate
                id="forms">
                {% csrf_token %}
                <fieldset class="form-group">
                  <div class="row">
                    <label class="col-form-label col-sm-2 pt-3">Mode of Adjustment</label>
                  
                    <div class="col-sm-10">
                      <div class="col-sm-10 form-inline">
                        <div class="form-check " style="margin-left: -2.2rem;">
                          <input required class="form-check-input " type="radio" name="type" id="gridRadios1" value="Goods" style="margin-left:5px;">
                          <label class="form-check-label" for="gridRadios1" style="color: white;">Quantity Adjustment</label>
                        </div>
                        <div class="form-check ml-5">
                          <input required class="form-check-input " type="radio" name="type" id="gridRadios2" value="Services" style="margin-left:50px;">
                          <label class="form-check-label" for="gridRadios2" style="color: white;">Value Adjustment</label>
                        </div>
                              
                      </div>
                            
                    </div>
                  </div>
                </fieldset>
                   
                <div class="form-group row">
                  <label  class="col-sm-2 col-form-label ">Reference Number</label>
                  <div class="col-sm-6 col-md-5 col-6" style="margin-left: -2.2rem;">
                    <input required type="text" class="form-control bg-white text-dark" name="name" id="nameInput" oninput="validateInput(this)">
                    <div id="validationResult"></div>
                    
                  </div>
                </div>
            

            <script>
              function validateInput(input) {
                  var inputValue = input.value;
                  var hasCharacter = /[a-zA-Z]/.test(inputValue);
                  var hasNumber = /\d/.test(inputValue);

                  var validationResultDiv = document.getElementById("validationResult");
            
                  if (hasCharacter && hasNumber) {
                      // input.setCustomValidity('');
                      validationResultDiv.textContent = " ";
                  } else {
                      validationResultDiv.textContent = "Invalid: The field should contain atleast a number and a character.";
                      // input.setCustomValidity('Input must contain at least one character and one number.');
                  }
              }
            </script>
             
             <div class="form-group row">
              <label class="col-sm-2 col-form-label">Date *</label>
              <div class="col-sm-6 col-md-5 col-6" style="margin-left: -2.2rem;">
                  <input required type="date" class="form-control bg-white text-dark" name="date" id="dateInput">
              </div>
          </div>

          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Account *</label>
            <div class="col-sm-6 col-md-5 col-6" style="margin-left: -2.2rem;">
                <select name="unit" class="form-control bg-white text-dark" id="unit">
                    {% for a in accounts %}
                    <option value="{{u.id}}">{{a.account_name}}</option>
                    
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Reason *</label>
          <div class="col-sm-6 col-md-5 col-6" style="margin-left: -2.2rem;">
              <select name="unit" class="form-control bg-white text-dark" id="unit">
                <option value="{{u.id}}" selected hidden disabled>Select a reason</option>
                  <option value="{{u.id}}">Stock on fire</option>
                  <option value="{{u.id}}">Stolen goods</option>
                  <option value="{{u.id}}">Damaged goods</option>
                  <option value="{{u.id}}">Stock Written off</option>
                  <option value="{{u.id}}">Stocktaking results</option>
                  <option value="{{u.id}}">Inventory Revaluation</option>


              </select>
          </div>
          <div class="col-2">

            <!-- onclick="openForm()" -->
            <a href="#" class="btn btn-outline-secondary py-2 mt-1 mx-1 mx-auto p-3" style="background-color: white;color: #000; padding-bottom: 6px!important;" data-target="#newreason" data-toggle="modal">Add Reason</a></button>
        </div>
      </div>

      
      <div class="form-group row">
        <label class="col-sm-2 col-form-label">Description</label>
        <div class="col-sm-6 col-md-5 col-6" style="margin-left: -2.2rem;">
            <textarea name="" id="" cols="66" rows="3" style=" border:1px white solid;border-radius:5px;" placeholder="&nbsp;Max 500 characters"></textarea>
        </div>
    </div>



               
                

               

               
<!-- .............................................  TABLE 1  ..................................................... -->

                  
                <div class="row" id="tab_row1">
                    <div class="col-sm-12 col-lg-12 col-md-12 ">
                        <label for="" id="label_tab1" class="tab1"></label><br>
                        <div style="width: 100%;">
                            <table class="table  text-black table-bordered tab1" id="item_table" style="background-color: rgba(250, 227, 198, 0.8);table-layout: fixed;width: 100%;background-color: #b6b3b36b;"
                            onchange="calc()">
                            <thead>
                                <tr>
                                    <th class="" style="font-weight: bold;color: rgb(245, 154, 36);" >Item Details <a href="" data-toggle="modal" data-target="#newitem"><i class="fas fa-plus p-2 rounded"
                                                style="color: white; background-color: rgb(210, 132, 30);"></i></a></th>
                                    <th class="text-right" style="font-weight: bold;color: rgb(245, 154, 36);">Quantity Available</th>
                                    <th class="text-right" style="font-weight: bold;color: rgb(245, 154, 36);">New Quantity on Hand</th>
                                    <th class="text-right" style="font-weight: bold;color: rgb(245, 154, 36);">Quantity Adjusted</th>
                                </tr>
                            </thead>
                            <tbody>
        
                                <tr id='row1'>
                                    <td>
                                        <div class='form-group'><select
                                                class=' bg-transparent text-light border-0 item_select itm'
                                                name='item[]' id='item1'>
                                                <option class='text-dark'>Select Items</option>
                                                {% for i in items %}
                                                <option class="text-dark" value="{{i.Name}}">{{i.Name}}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </td>
                                    <td class='text-right'><input type='number' id='qty1'
                                            class='form-control bg-transparent border-0 text-light text-right qty' name='quantity[]'
                                            value='0'>
                                    </td>
                                    <td class='text-right'><input type='number' id='rate1'
                                            class='form-control bg-transparent border-0 text-light text-right rate' name='rate[]'
                                            value='0.00'>
                                    </td>
                                    <td class='text-right'><input type='number' id='discount1'
                                            class='form-control bg-transparent border-0 text-light text-right discount' name='discount[]'
                                            value='0.00'>
                                    </td>
                                    

                                   
                                    <td class='text-center'><button type='button' id='del_btn1'
                                            class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row'
                                            style='width:30px'><i class='fa fa-times'></i></button>
                                                
                                              </td>
                                </tr>
                            </tbody>
        
                        </table>
                        <button type="button" class="btn btn-sm text-white tab1" style="background-color: rgb(210, 132, 30) ;"
                            id="add-row" onclick="cust_mail1()" title="add row"><i class="fa-solid  fa fa-plus rounded"
                            style="color: white; background-color: rgb(210, 132, 30);height: 20px;"></i></button>
                    </div>
                    
 
                </div>



                
<!-- ..................................................   END TABLE1   .......................................................... -->

<!-- ...................................................  TABLE 2  ..................................................... -->

                  
<div class="row " id="tab_row2" >
    <div class="col-sm-12 col-lg-12 col-md-12" >
        <label for="" id="label_tab2" class="tab2" style="display: none;">Price List</label><br>
        <div style="width: 100%;">
            <table class="table  text-black table-bordered tab2 " id="item_tablee" style="background-color: rgba(250, 227, 198, 0.8);table-layout: fixed;width: 100%;background-color: #b6b3b36b; display: none;"
            onchange="calc()" >
            <thead>
                <tr>
                    <th class="" style="font-weight: bold;color:rgb(245, 154, 36);">Item Details <a href="" data-toggle="modal" data-target="#newitem"><i class="fas fa-plus p-2 rounded"
                                style="color: white; background-color: rgb(210, 132, 30);"></i></a></th>
                    <th class="text-right" style="font-weight: bold;color:rgb(245, 154, 36);">Quantity</th>
                    <th class="text-right" style="font-weight: bold;color:rgb(245, 154, 36);">Rate</th>
                    <th class="text-right" style="font-weight: bold;color:rgb(245, 154, 36);">Discount</th>
                    <th class="text-right" style="font-weight: bold;color:rgb(245, 154, 36);" >Tax</th>
                    <th class="text-right" style="font-weight: bold;color:rgb(245, 154, 36);">Amount</th>
                </tr>
            </thead>
            <tbody>

                <tr id='row1'>
                    <td>
                        <div class='form-group'><select
                                class=' bg-transparent text-light border-0 item_selectt itmm'
                                name='itemm[]' id='itemm1'>
                                <option class='text-dark'>Select Items</option>
                                {% for i in items %}
                                <option class="text-dark" value="{{i.Name}}">{{i.Name}}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </td>
                    <td class='text-right'><input type='number' id='qtyy1'
                            class='form-control bg-transparent border-0 text-light text-right qtyy' name='quantityy[]'
                            value='0'>
                    </td>
                    <td class='text-right'><input type='number' id='ratee1'
                            class='form-control bg-transparent border-0 text-light text-right ratee' name='ratee[]'
                            value='0.00'>
                    </td>
                    <td class='text-right'><input type='number' id='discountt1'
                            class='form-control bg-transparent border-0 text-light text-right discountt' name='discountt[]'
                            value='0.00'>
                    </td>
                    <td class='text-right'> 
                        <select name='taxx[]' id='taxx'
                            class=' bg-transparent text-light text-right border-0 taxx' style="width: 85%;" >
                            <option value="" selected>select</option>

                            <!-- <option value=0 class="opt1">Non Taxable</option> -->
                            <option value=0 class="opt1 text-dark">0% IGST</option>
                            <option value=3 class="opt1 text-dark">3% IGST</option>
                            <option value=5 class="opt1 text-dark">5% IGST</option>
                            <option value=12 class="opt1 text-dark">12% IGST</option>
                            <option value=18 class="opt1 text-dark">18% IGST</option>
                            <option value=28 class="opt1 text-dark">28% IGST</option> 

                            
                            
                        </select>
                       
                    </td>

                    <td style="display: none;">
                        <input type="number" name='taxamountt[]' id="taxamountt1"
                            class="form-control bg-transparent border-0 text-light text-right taxamountt" />
                    </td>
                    <td class='text-right'><input type='number' id='amountt1'
                            class='bg-transparent border-0 text-light text-right amountt' name='amountt[]'
                            value='0.00' style="width: 85%;"></td>
                    <td class='text-center'><button type='button' id='del_btnn1'
                            class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-roww'
                            style='width:30px'><i class='fa fa-times'></i></button>
                                <button type='button' class='btn btn-transparent text-primary btn-sm btn-outline-primary rounded-circle clone-roww' data-row=1 style='width:30px'><i class="fa fa-clone"></i>
                                </button>
                              </td>
                </tr>
            </tbody>

        </table>
        <button type="button" class="btn btn-sm text-white tab2" style="background-color: rgb(210, 132, 30);display: none;"
            id="add-roww" onclick="cust_mail1()"><i class="fa-solid  fa fa-plus rounded"
            style="color: white; background-color: rgb(210, 132, 30);height: 20px;"></i></button>
    </div>
    
    
 

</div>




<!-- ..................................................   END TABLE 2   .......................................................... -->


          
                    <div class="row">
                        <div class="-sm-12 col-md-6 col-lg-6">
                            <input type="submit" class="btn text-white mt-5" style="background-color:  rgb(59, 59, 58) ; " 
                onclick="saveAsDraftDialog()" value="Save As Draft">
                <input type="submit" class="btn text-white mt-5" style="background-color: rgb(210, 132, 30) ; "
                    onclick="saveAndSendDialog()" value="Convert to Adjusted">
                    <input type="submit" class="btn text-white mt-5" style="background-color:  rgb(59, 59, 58) ; "
                            onclick="cancelDialog()" value="Cancel">
                        </div>
                        <div class="-sm-12 col-md-6 col-lg-6"></div>
                    </div>
            </form>

            <!--..................................... item modal ..................................................-->

            <div class="modal fade" id="newitem">
              <div class="modal-dialog modal-xl">
                <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
                  <div class="modal-header " style="background: rgb(32, 35, 37);">
                      <h3 class="m-3 text-uppercase">New Item</h3>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                      </button>
                  </div>
                  <div class="modal-body" style="background: rgb(32, 35, 37);">
                    <div class="card p-3 m-3">
                      <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalItem">
          
                        <div class="row mt-2">
                          <div class="col-md-4 mr-0">
                            <label class="col-form-label col-sm-2 p-0">Type <i class="fa fa-question-circle"></i></label>
                          </div>
                          <div class="col-md-5 ml-0 d-flex">
                            <div class="radio_opt mx-5 ">
                              <input type="radio" id="item_type1" name="radioOption" value="Goods" >
                              <label for="option1">Goods</label>
                            </div>
                            <div class="radio_opt mx-5 ">
                              <input type="radio" id="item_type2" name="radioOption" value="Services" >
                              <label for="option2">Services</label>
                            </div>
                          </div>
                        </div>
                        <div class="row mt-2">
                          <div class="col-md-3">
                            <label for="name" style="color: rgb(190, 88, 88);">Name *</label>
                          </div>
                          <div class="col-md-6">
                            <input type="text" class="form-control bg-light text-dark" id="item_name" name="item_name" required>
                          </div>
                        </div>
                        <div class="row mt-2">
                          <div class="col-md-3 ">
                            <label for="units">Unit</label>
                          </div>
                          <div class="col-md-6">
                            <div class="d-flex">
                              <select class="form-control bg-light text-dark" id="item_units" name="item_units" required>
                                <option value="" hidden>Select Unit</option>
                                {% for u in units %}
                                <option value="{{u.id}}">{{u.unit}}</option>
                                {% endfor %}
                              </select>                
                              <a href="#" class="btn btn-outline-secondary py-2 mb-1 mx-1" style="padding-bottom: 3px!important;" data-target="#newunit" data-toggle="modal">+</a>  
                            </div>
                          </div>
                        </div>
          
                        <div class="row mt-2">
                          <div class="col-md-4 ">
                            <label for="c_tax" style="color: rgb(190, 88, 88);">Tax Preference * </label>
                          </div>
                          <div class="col-md-5">
                            <div class="d-flex">
                              <div class="radio_opt mx-5 mt-2">
                                <input type="radio" id="item-tax1" name="radioOption1" value="Taxable" >
                                <label for="option1">Taxable</label>
                              </div>
                              <div class="radio_opt mx-4 mt-2">
                                <input type="radio" id="item-tax2" name="radioOption1" value="Tax-exempt" >
                                <label for="option2">Tax-exempt</label>
                              </div>
                            </div>
                          </div>       
                        </div>
          
                        <div class="row mt-2 mb-4 d-none inter-intra" >
                          <div class="col-md-3">
                            <label for="intra">Intra-State TAX</label>
                          </div>
                          <div class="col-md-3">
                            <select name="intra" class="form-control bg-light text-dark" id="intra">
                              <option value="">Select GST</option>
          
                              <option value="GST0[0%]">GST0[0%]</option>
                              <option value="GST5[5%]">GST5[5%]</option>
                              <option value="GST12[12%]">GST12[12%]</option>
                              <option value="GST18[18%]">GST18[18%]</option>
                              <option value="GST28[28%]">GST28[28%]</option>
                            </select>             
                          </div>
          
                          
                          <div class="col-md-2">
                            <label for="inter">Inter-State TAX</label>
                          </div>
                          <div class="col-md-3">
                            <select name="inter" class="form-control bg-light text-dark" id="inter">
                              <option value="">Select GST</option>
          
                              <option value="IGST0[0%]">IGST0[0%]</option>
                              <option value="IGST5[5%]">IGST5[5%]</option>
                              <option value="IGST12[12%]">IGST12[12%]</option>
                              <option value="IGST18[18%]">IGST18[18%]]</option>
                              <option value="IGST28[28%]">IGST28[28%]</option>
                            </select>               
                          </div>
                          <div class="col-md-1"></div>
          
                        </div>
                        
                        <hr>
          
                        <div class="row mt-5 text-center">
                          <div class="col-md-6 d-flex text-center">
                            <input  type="checkbox" name="selling" checked class="mx-2 my-0">
                            <h6 class="m-0">Selling Information</h6>
                          </div>
                          <div class="col-md-6 d-flex text-center">
                            <input  type="checkbox" name="purchase" checked class="mx-2 my-0">
                            <h6 class="m-0">Purchase Information</h6>
                          </div>
                        </div>
                        
                        <div class="row mt-4">
                          <div class="col-md-2">
                            <label for="sell_price">Selling Price *</label>
                          </div>
                          <div class="col-md-4">
                            <div class="input-group mb-2">
                              <div class="input-group-prepend">
                                <div class="input-group-text text-white">INR</div>
                              </div>
                              <input required type="text" class="form-control bg-light text-dark" name="sell_price" id="sell_price">
                            </div>                  
                          </div>
          
                          <div class="col-md-2">
                            <label for="cost_price">Cost Price *</label>
                          </div>
                          <div class="col-md-4 ">
                            <div class="input-group mb-2">
                              <div class="input-group-prepend">
                                <div class="input-group-text text-white">INR</div>
                              </div>
                              <input required type="text" class="form-control bg-light text-dark" name="cost_price" id="cost_price">
                            </div>
                          </div>
                        </div>
          
                        <div class="row mt-2">
                          <div class="col-md-2">
                            <label for="vcity">Account</label>
                          </div>
                          <div class="col-md-4">
                            <select name="sell_acc" id="sell_acc" class="form-control bg-light text-dark">
                              <option value="">Select Account</option>
               
                                <option value="" disabled class="btn btn-dark text-white"><b>SALES</b></option>
                                {% for s in sales %}
                                    <option value="{{s.id}}">{{ s.Account_name }}</option>
                              {% endfor %}
                            </select> 
                          </div>
                          <div class="col-md-2">
                            <label for="cost_acc">Account</label>
                          </div>
                          <div class="col-md-4">
                            <select name="cost_acc" class="form-control bg-light text-dark" id="cost_acc">
                              <option value="">Select Account</option>
          
          
                              
                                <option value="" disabled class="btn btn-dark text-white"><b>PURCHASE</b></option>
                                {% for p in purchase %}
                                    <option value="{{p.id}}">{{ p.Account_name }}</option>
                              {% endfor %}
          
                            </select> 
                          </div>
                        </div>
          
                        <div class="row mt-2">
                          <div class="col-md-2">
                            <label for="sell_desc">Description</label>
                          </div>
                          <div class="col-md-4">
                            <input  type="text" name="sell_desc" class="form-control bg-light text-dark"  id="sell_desc">
                          </div>
          
                          <div class="col-md-2">
                            <label for="cost_desc">Description</label>
                          </div>
                          <div class="col-md-4 ">
                            <input  type="text" name="cost_desc" class="form-control bg-light text-dark"  id="cost_desc">
                          </div>
          
                        </div>
          
                        <div class="row mt-3">
                            <div class="col-md-6">
                              <input type="checkbox" value="" id="invalidCheck" name="invalidCheck" required>
                              <label for="invalidCheck" style="color:white;">Agree to terms and conditions</label>
                              <div class="invalid-feedback text-warning" >You must agree before submitting.</div>
                            </div>
                        </div>
                        <div class="row">
                          <div class="col-md-4"></div>
                          <div class="col-md-4">
                            <div class="d-flex">
                              <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                              type="submit" data-dismiss="modal" id="itemSave">Submit
                              </button> 
          
                              <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                                data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">Cancel</span>
                              </button>
                            </div>
                          </div>
                          <div class="col-md-4"></div>
                        </div>
                      </form>
                          </div>
                      </div>
                  </div>
              </div>  
            </div> 
          
          
          
          <!-- ....................................................  END ITEM MODAL................................. -->



          <!-- ADD REASON -->
          <div class="modal fade" id="newreason">
            <div class="modal-dialog modal-xl">
              <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
                <div class="modal-header " style="background: rgb(32, 35, 37);">
                    <h3 class="m-3 text-uppercase">New Adjustment</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="background: rgb(32, 35, 37);">
                  <div class="card p-3 m-3">
                    
                      {% csrf_token %}
                      <div class="row mt-2">
                        <div class="col-md-3 mt-2"></div>
                        <div class="col-md-1 mt-2">
                          

                          <!-- <label for="unit" style="color: rgb(190, 88, 88);">Reason</label> -->
                        </div>
                        

                        <div style="margin-left: 50px; padding-bottom: 30px;">
                          <button class="btn-warning text-white" style="border-radius: 6px;" id="showReasonInput" >+ Add new Reason</button>
                          <div id="reasonInput" style="display: none;">
                            <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalUnit">
                              <label for="" style="color: red;margin-bottom: 20px;">Reason *</label>
                              <input type="text" class="form-control bg-light text-dark" style="width: 600px;" id="newReason" name="newReason" required>
                              <div class="d-flex">
                                <button class="btn save_btn rounded-pill text-grey  my-4" style="width: 150px;" type="button" id="saveReason">Save</button>
                                &nbsp;&nbsp;
                                <button type="button" class="close btn save_btn rounded-pill text-grey  my-4" style="width: 150px;" id="cancelReason">Cancel</button>
                              </div>
                            </form>
                          </div>
                        </div>


                        <!-- <div style="margin-left: 50px; padding-bottom: 30px;">
                          <button class="btn-warning text-white" style="border-radius: 6px;" id="showReasonInput">+ Add new Reason</button>
                          <div id="reasonInput" style="display: none;">
                            <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalUnit">
                              <label for="" style="color: red;margin-bottom: 20px;">Reason *</label>
                            <input type="text" class="form-control bg-light text-dark" style="width: 600px;" id="newReason" name="newReason" required>
                          
                            <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3 d-flex" type="button" id="saveReason" >Save</button>
                            <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" id="cancelReason">Cancel</button>
                          </form>
                          </div>
                        </div> -->
                        




        
                        <!-- <div style="margin-left: 50px; padding-bottom: 30px;" >
                          <button class="btn-warning text-white" style="border-radius: 6px;" > + Add new Reason </button>

                          

                           <input type="text" class="form-control bg-light text-dark" id="unit" name="unit" required> 
                        </div> -->

                        <div style="margin-left: 50px;">
                          <hr width="950px;">
                          <label for="unit">REASON</label>
                          <hr width="950px;">

                  
                          <ul class="list-unstyled">
                            <li class="py-2">Stock on fire</li>
                            <li  class="py-2">Stolen goods</li>
                            <li  class="py-2">Damaged goods</li>
                            <li  class="py-2">Stock Written off</li>
                            <li  class="py-2">Stocktaking results</li>
                            <li  class="py-2">Inventory Revaluation</li>

                            <li  class="py-2"></li>
                            
                          </ul>
                        
                          <!-- <input type="text" class="form-control bg-light text-dark" id="unit" name="unit" required> -->
                        </div>


                        <div class="col-md-4 mt-2"></div>
                      </div>
                      
                      <!-- <div class="row mt-5">
                        <div class="col-md-4"></div>
                        <div class="col-md-4">
                          <div class="d-flex">
                            <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                            type="submit" data-dismiss="modal" id="unitSave">Save
                            </button> 
                            
        
                            <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                              data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">Cancel</span>
                            </button>
                          </div>
                        </div>
                        <div class="col-md-4"></div>
                      </div> -->

                    
                  </div>
                </div>
              </div>
            </div>  
          </div>  
       <!-- ADD REASON -->



       <script>
        document.addEventListener('DOMContentLoaded', function() {
          // Get references to the elements
          var showReasonInputBtn = document.getElementById('showReasonInput');
          var reasonInput = document.getElementById('reasonInput');
          var newReasonInput = document.getElementById('newReason');
          var saveReasonBtn = document.getElementById('saveReason');
          var cancelReasonBtn = document.getElementById('cancelReason');
        
          // Add click event listener to the "+ Add new Reason" button
          showReasonInputBtn.addEventListener('click', function(event) {
            showReasonInputBtn.style.display = 'none';
            event.preventDefault(); // Prevent form submission
            reasonInput.style.display = 'block'; // Show the input box and buttons
          });
        
          // Add click event listener to the "Cancel" button
          cancelReasonBtn.addEventListener('click', function() {
            reasonInput.style.display = 'none'; // Hide the input box and buttons
            newReasonInput.value = ''; // Clear the input field
            showReasonInputBtn.style.display = '';
          });
        });
      </script>
      



    


<!-- ............................................unit modal............................................ -->

<div class="modal fade" id="newunit">
    <div class="modal-dialog modal-xl">
      <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
        <div class="modal-header " style="background: rgb(32, 35, 37);">
            <h3 class="m-3 text-uppercase">Add Unit</h3>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" style="background: rgb(32, 35, 37);">
          <div class="card p-3 m-3">
            <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalUnit">
              <div class="row mt-2">
                <div class="col-md-3 mt-2"></div>
                <div class="col-md-1 mt-2">
                  <label for="unit" style="color: rgb(190, 88, 88);">Unit</label>
                </div>

                <div class="col-md-4 mt-2">
                  <input type="text" class="form-control bg-light text-dark" id="unit" name="unit" required>
                </div>
                <div class="col-md-4 mt-2"></div>
              </div>
              
              <div class="row mt-5">
                <div class="col-md-4"></div>
                <div class="col-md-4">
                  <div class="d-flex">
                    <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                    type="submit" data-dismiss="modal" id="unitSave">Save
                    </button> 
                    

                    <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                      data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">Cancel</span>
                    </button>
                  </div>
                </div>
                <div class="col-md-4"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>  
  </div>  
<!-- ............................................  END UNIT MODAL..................................................... -->



    <!-- ###################################################################################### -->





        </div>
    </div>

   

</section>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.4.js" integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E="
    crossorigin="anonymous"></script>
    







<script>




    // set todays date on estimate date field
    var today = new Date().toISOString().substr(0, 10);
    document.getElementById("estimate_date").value = today;
    document.getElementById("expiry_date").value = today;

    // Add new row
    $(document).ready(function () {
        $('#add-row').click(function () {
            var table = document.getElementById("item_table");
            var RowCount = table.rows.length;
            console.log(RowCount);
            var newRow = $(`
            <tr id='row${RowCount}'>
                <td>
                    <div class='form-group'>
                        <select
                            class='bg-transparent text-light border-0 item_select' name='item[]'
                            id='item${RowCount}'>
                            <option class='text-dark'>Select Items</option>
                            {% for i in items %}
                            <option class="text-dark" value="{{i.Name}}">{{i.Name}}</option>
                            {% endfor %}
                        </select></div>
                </td>
                <td class='text-right '><input type='number' id='qty${RowCount}'
                        class='form_control bg-transparent border-0 text-light text-right qty' name='quantity[]' style="width:85%" value='0.00' >
                </td>
                <td class='text-right '><input type='number' id='rate${RowCount}'
                        class='form_control bg-transparent border-0 text-light text-right rate' name='rate[]' value='0.00' style="width:85%"></td>
                <td class='text-right'><input type='number' id='discount${RowCount}'
                        class='form_control bg-transparent border-0 text-light text-right discount' name='discount[]' value='0.00' style="width:85%">
                </td>
                <td class='text-right'> <select name='tax[]' id='tax${RowCount}'
                        class="bg-transparent text-light text-right border-0 tax" style="width:85%">
                        <option value="" selected>select</option>
                        <option value=0 class="text-dark">0% GST</option>
                        <option value=3 class="text-dark">3% GST</option>
                        <option value=5 class="text-dark">5% GST</option>
                        <option value=12 class="text-dark">12% GST</option>
                        <option value=18 class="text-dark">18% GST</option>
                        <option value=28 class="text-dark">28% GST</option>
                       
                    </select>
                    
                    </td>
                <td style="display: none;">
                    <input type="text" name='taxamount1' id="taxamount${RowCount}"  class="form-control bg-transparent border-0 text-light text-right taxamount" />
                            </td>
                <td class='text-right'><input type='number' id='amount${RowCount}'
                        class='bg-transparent border-0 text-light text-right amount' style="width:85%" name='amount[]' value='0.00'></td>
                <td class='text-center'><button type='button' id='del_btn${RowCount}'
                        class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row'
                        style='width:30px'><i class='fa fa-times'></i></button>
                        <button type='button' class='btn btn-transparent text-primary btn-sm btn-outline-primary rounded-circle clone-row' data-row=1 style='width:30px'><i class="fa fa-clone"></i></button>
                        </td>
            </tr>`);
            $('#item_table').append(newRow);
        });

        $('#item_table').on('click', '.delete-row', function () {
            $(this).closest('tr').remove();
            calc();
        });

    });




    //.......................................................... Add new row TABLE 2 .......................................
    $(document).ready(function () {
        $('#add-roww').click(function () {
            var tablee = document.getElementById("item_tablee");
            var RowCountt = tablee.rows.length;
            console.log(RowCountt);
            var newRoww = $(`
            <tr id='row${RowCountt}'>
                <td>
                    <div class='form-group'>
                        <select
                            class='bg-transparent text-light border-0 item_selectt' name='itemm[]'
                            id='itemm${RowCountt}'>
                            <option class='text-dark'>Select Items</option>
                            {% for i in items %}
                            <option class="text-dark" value="{{i.Name}}">{{i.Name}}</option>
                            {% endfor %}
                        </select></div>
                </td>
                <td class='text-right '><input type='number' id='qtyy${RowCountt}'
                        class='form_control bg-transparent border-0 text-light text-right qtyy' name='quantityy[]' style="width:85%" value='0.00' >
                </td>
                <td class='text-right '><input type='number' id='ratee${RowCountt}'
                        class='form_control bg-transparent border-0 text-light text-right ratee' name='ratee[]' value='0.00' style="width:85%"></td>
                <td class='text-right'><input type='number' id='discountt${RowCountt}'
                        class='form_control bg-transparent border-0 text-light text-right discountt' name='discountt[]' value='0.00' style="width:85%">
                </td>
                <td class='text-right'> <select name='taxx[]' id='taxx${RowCountt}'
                        class="bg-transparent text-light text-right border-0 taxx" style="width:85%">
                        <option value="" selected>select</option>
                        <option value=0 class="text-dark">0% IGST</option>
                        <option value=3 class="text-dark">3% IGST</option>

                        <option value=5 class="text-dark">5% IGST</option>
                        <option value=12 class="text-dark">12% IGST</option>
                        <option value=18 class="text-dark">18% IGST</option>
                        <option value=28 class="text-dark">28% IGST</option>
                       
                    </select>
                    
                    </td>
                <td style="display: none;">
                    <input type="text" name='taxamountt1' id="taxamountt${RowCountt}"  class="form-control bg-transparent border-0 text-light text-right taxamountt" />
                            </td>
                <td class='text-right'><input type='number' id='amountt${RowCountt}'
                        class='bg-transparent border-0 text-light text-right amountt' style="width:85%" name='amountt[]' value='0.00'></td>
                <td class='text-center'><button type='button' id='del_btnn${RowCountt}'
                        class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-roww'
                        style='width:30px'><i class='fa fa-times'></i></button>
                        <button type='button' class='btn btn-transparent text-primary btn-sm btn-outline-primary rounded-circle clone-roww' data-row=1 style='width:30px'><i class="fa fa-clone"></i></button>
                        </td>
            </tr>`);
            $('#item_tablee').append(newRoww);
        });

        $('#item_tablee').on('click', '.delete-roww', function () {
            $(this).closest('tr').remove();
            calc();
        });

    });



// Event handler for clone button
var rowCount = 1;
$('#item_table').on('click', '.clone-row', function () {
  var row = $(this).closest('tr');
  var clonedRow = row.clone(); // Clone the current row
  var newRowId = 'row' + rowCount; // Generate a new ID for the cloned row
  clonedRow.attr('id', newRowId); // Set the new ID for the cloned row

  // Clone the options for tax, account, and item
  var currentItem = row.find('.item_select').val();
  clonedRow.find('.item_select').val(currentItem);
  
  var currentTax = row.find('.tax').val();
  clonedRow.find('.tax').val(currentTax);

  rowCount++; // Increment row counter

  $('#item_table tbody').append(clonedRow);
  var row = $(this).closest('tr');
  calc();
  calc_total();
     
});

//........................... Event handler for clone button  TABLE 2  ...................................
var rowCountt = 1;
$('#item_tablee').on('click', '.clone-roww', function () {
  var roww = $(this).closest('tr');
  var clonedRoww = roww.clone(); // Clone the current row
  var newRowIdd = 'row' + rowCountt; // Generate a new ID for the cloned row
  clonedRoww.attr('id', newRowIdd); // Set the new ID for the cloned row

  // Clone the options for tax, account, and item
  var currentItemm = roww.find('.item_selectt').val();
  clonedRoww.find('.item_selectt').val(currentItemm);
  
  var currentTaxx = roww.find('.taxx').val();
  clonedRoww.find('.taxx').val(currentTaxx);

  rowCountt++; // Increment row counter

  $('#item_tablee tbody').append(clonedRoww);
  var roww = $(this).closest('tr');
  calc();
  calc_total();
     
});


</script>

<script>



$(document).ready(function() {
    $("#cfname, #clname").change(function() {
      $("#cdisplayname").text($("#ctitle").val() +" " + $("#cfname").val() + " " + $("#clname").val());
    });
  });


    //---------modal customer-----

// ######################################################################

$(document).on("click","#customerSave",function(){

if ($('input[name="radioCust"]:checked').val() == 'Business'){

  custType = $('#business').val();
}
else{
  custType = $('#individual').val();
}
  
if ($('input[name="radioCust1"]:checked').val() == 'Taxable'){
  cust_tax = $('#custtax1').val();
}
else{
    cust_tax = $('#custtax2').val();
}
$.ajax({
  
  type : 'POST',
  url:"{% url 'recurbills_customer' %}",

  data:{
      customer_type : custType,
      display_name : $('#cdisplayname').text(),
      company_name : $('#ccompany').val(),
      email : $("#cemail").val(),
      work_mobile :$("#cw_mobile").val(),
      pers_mobile :$("#cp_mobile").val(),
      facebook :$("#facebook").val(),
      twitter :$("#twitter").val(),
      website :$("#website").val(),
      skype :$("#cskype").val(),
      desg :$("#c_desg").val(),
      dpt :$("#c_dpt").val(),
      gsttype :$("#c_gsttype").val(),
      placeofsupply :$("#placesupply").val(),
      tax_preference :cust_tax,
      currency : $("#c_curn").val(),
      openingbalance : $("#c_open").val(),
      paymentterms : $("#c_terms").val(),
      street1 : $("#cstreet1").val(),
      street2 : $("#cstreet2").val(),
      city : $("#ccity").val(),
      state : $("#cstate").val(),
      pincode : $("#cpincode").val(),
      fax : $("#cfax").val(),
      phone : $("#cphone").val(),
      country : $("ccountry").val(),
      csrfmiddlewaretoken: '{{ csrf_token }}'
      
    },
  
    success: function(response) {
      document.getElementById("modalCustomer").reset();
      reloadCustomer();
    },
});        
});

function reloadCustomer() {

$.ajax({ 
  url: "{% url 'customer_dropdown' %}",
  type: "GET",
  dataType: "json",
  data: $(this).serialize(),
  csrfmiddlewaretoken: '{{ csrf_token }}',

  success: function(data) {
    var dropdown = $('#customer_sel');
    dropdown.empty();
    $.each(data, function(key, value) {
        // dropdown.append($('<option></option>').attr('value', key).text(value[1]).val(value[0] + ' ' + value[1]));
        dropdown.append($('<option></option>').attr('value', key).text(value[1]).val(key));
    });
  },
  error: function(xhr, status, error) {
  console.error(xhr.responseText);
  }
});
}




$(document).ready(function() {
    $('#customer_sel').change(function() {

        var name = $("#customer_sel").val();
        var na = name.split(' ')[0];
        var table = document.getElementById("item_table");
        $.ajax({

            url: "{% url 'get_customerdet' %}", 

            data: { 
                    id : na,
                    csrfmiddlewaretoken: '{{ csrf_token }}' 
                },

            type : 'POST',

            success: function(data) {

              $("#cemail_row").removeClass('d-none');
              $("#cemail_row").addClass('d-flex');
              
              
              $('#customer_mail').val(' '+ data.customer_email);
              $('#cus_place').val(data.cust_place_supply);
              $('#customer_id').val(data.cust_id);
              var x=document.getElementById("cus_place").value
              
              var y=document.getElementById("state").value
                                if ( x == y )
                                {
                                   document.getElementById("item_table").style.display="block"
                                   document.getElementById("item_tablee").style.display="none"
                                   document.getElementById("label_tab1").style.display="block"
                                   document.getElementById("label_tab2").style.display="none"
                                   document.getElementById("add-row").style.display="block"
                                   document.getElementById("add-roww").style.display="none"
                                  


                                    
                        
                                }
                                else
                                {
                                   document.getElementById("item_table").style.display="none"
                                   document.getElementById("item_tablee").style.display="block"
                                   document.getElementById("label_tab1").style.display="none"
                                   document.getElementById("label_tab2").style.display="block"
                                   document.getElementById("add-row").style.display="none"
                                   document.getElementById("add-roww").style.display="block"
                                    
                                    
                                }
                    
              
            }
           
        });
    });
});





//--------payment terms modal-----------

$(document).on("click","#paySave",function(){
  $.ajax({
    
    type : 'POST',
    url:"{% url 'recurbills_pay' %}",

    data:{
        name : $("#term_name").val(),
        days : $("#term_days").val(),
        
        csrfmiddlewaretoken: '{{ csrf_token }}'
        
      },
    
      success: function(response) {
        document.getElementById("modalPayment").reset();
        reloadPayment();
      },
  });        
});

function reloadPayment() {

  $.ajax({
    url: "{% url 'pay_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('#terms');
      dropdown.empty();
      dropdown.append(`<option selected value="15">NET 15</option>
                          <option value="30">NET 30</option>
                          <option value="45">NET 45</option>
                          <option value="60">NET 60</option>
                          <option value="90">NET 90</option>
                          <option value="">Due end of the month</option>
                          <option value="recpt">Due on receipt</option>`);
      var drpv = $('#v_terms');
      drpv.empty();
      drpv.append(`<option selected value="15">NET 15</option>
                        <option value="30">NET 30</option>
                        <option value="45">NET 45</option>
                        <option value="60">NET 60</option>
                        <option value="90">NET 90</option>
                        <option value="">Due end of the month</option>
                        <option value="recpt">Due on receipt</option>`);
      $.each(data, function(key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value[0]).val(value[1]));
          drpv.append($('<option></option>').attr('value', key).text(value).val(value));
      });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}



  // item modal

$(document).ready(function() {
  $("#item-tax1").click(function() {
  //  console.log($("#item_units").val().split(' ')[0]);
    $(".inter-intra").removeClass('d-none');
    $(".inter-intra").addClass('d-flex');
  });

  $("#item-tax2").click(function() {

    $(".inter-intra").removeClass('d-flex');
    $(".inter-intra").addClass("d-none");
  });
});

$(document).ready(function() {
  $("#item-tax3").click(function() {
  //  console.log($("#item_units").val().split(' ')[0]);
    $(".inter-intra").removeClass('d-none');
    $(".inter-intra").addClass('d-flex');
  });

  $("#item-tax4").click(function() {

    $(".inter-intra").removeClass('d-flex');
    $(".inter-intra").addClass("d-none");
  });
});

$(document).on("click","#itemSave",function(){

  if ($('input[name="radioOption"]:checked').val() == 'Goods'){

      itemtype = $('#item_type1').val();
    }
  else{
    itemtype = $('#item_type2').val();
  }

  if ($('input[name="radioOption1"]:checked').val() == 'Taxable'){
      inter = $('#inter').val();
      intra = $('#intra').val();
    }
  else{
    inter = 0;
    intra = 0;
  }

  
  $.ajax({
    
    type : 'POST',
    url:"{% url 'purchase_item' %}",
    
    data:{
        type : itemtype,
        name : $("#item_name").val(),
        unit : $("#item_units").val(),
        inter : inter,
        intra : intra,
        sell_price : $("#sell_price").val(),
        cost_price : $("#cost_price").val(),
        sell_acc : $("#sell_acc").val(),
        cost_acc : $("#cost_acc").val(),
        sell_desc : $("#sell_desc").val(),
        cost_desc : $("#cost_desc").val(),
        
        csrfmiddlewaretoken: '{{ csrf_token }}'
        
      },
    
      success: function(response) {
        document.getElementById("modalItem").reset();
        reloadItem();
      },
  });        
});


function reloadItem() {
  $.ajax({
    url: "{% url 'purchase_item_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('.itm');
      var dropdown1 = $('.itmm');
      dropdown.empty();
      dropdown1.empty();
      $.each(data, function(key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value).val(value));
          dropdown1.append($('<option></option>').attr('value', key).text(value).val(value));
      });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}


// unit modal


$(document).on("click","#unitSave",function(){
  $.ajax({
    
    type : 'POST',
    url:"{% url 'purchase_unit' %}",

    data:{
        unit : $("#unit").val(),      
        csrfmiddlewaretoken: '{{ csrf_token }}'
        
      },
    
      success: function(response) {
        document.getElementById("modalUnit").reset();
        reloadUnit();
      },
  });        
});


function reloadUnit() {

  $.ajax({
    url: "{% url 'purchase_unit_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('#item_units');
      dropdown.empty();

      $.each(data, function(key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value).val(value));
      });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}





</script>


<script>
    $(document).ready(function () {
        var roinc = 0
        console.log("ajax");
        // var place = document.getElementById('pos').value;
        $(document).on('click', '#item1', function () {
            select = $('#item1').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate1').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst1').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst1').value = data1
                    }
                    document.getElementById('tigst1').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst1').value = data2
                }
            });
        });
        // console.log('pos:'+place_of_supply);
        $(document).on('click', '#item2', function () {
            select = $('#item2').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate2').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst2').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst2').value = data1
                    }
                    document.getElementById('tigst2').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst2').value = data2

                }
            });

        });

        $(document).on('click', '#item3', function () {
            select = $('#item3').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate3').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst3').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst3').value = data1
                    }
                    document.getElementById('tigst3').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst3').value = data2

                }
            });

        });

        $(document).on('click', '#item4', function () {
            select = $('#item4').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate4').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst4').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst4').value = data1
                    }
                    document.getElementById('tigst4').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst4').value = data2

                }
            });

        });

        $(document).on('click', '#item5', function () {
            select = $('#item5').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate5').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst5').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst5').value = data1
                    }
                    document.getElementById('tigst5').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst5').value = data2

                }
            });

        });

        $(document).on('click', '#item6', function () {
            select = $('#item6').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate6').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst6').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst6').value = data1
                    }
                    document.getElementById('tigst6').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst6').value = data2

                }
            });

        });

        $(document).on('click', '#item7', function () {
            select = $('#item7').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate7').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst7').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst7').value = data1
                    }
                    document.getElementById('tigst7').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst7').value = data2

                }
            });

        });                 

        $(document).on('click', '#item8', function () {
            select = $('#item8').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate8').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst8').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst8').value = data1
                    }
                    document.getElementById('tigst8').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst8').value = data2

                }
            });

        });

        $(document).on('click', '#item9', function () {
            select = $('#item9').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate9').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst9').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst9').value = data1
                    }
                    document.getElementById('tigst9').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst9').value = data2

                }
            });

        });

        $(document).on('click', '#item10', function () {
            select = $('#item10').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate10').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst10').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst10').value = data1
                    }
                    document.getElementById('tigst10').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst10').value = data2

                }
            });

        });

        $(document).on('click', '#item11', function () {
            select = $('#item11').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate11').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst11').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst11').value = data1
                    }
                    document.getElementById('tigst11').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst11').value = data2

                }
            });

        });

        $(document).on('click', '#item12', function () {
            select = $('#item12').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate12').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst12').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst12').value = data1
                    }
                    document.getElementById('tigst12').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst12').value = data2

                }
            });

        });

        $(document).on('click', '#item13', function () {
            select = $('#item13').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate13').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst13').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst13').value = data1
                    }
                    document.getElementById('tigst13').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst13').value = data2

                }
            });

        });

        $(document).on('click', '#item14', function () {
            select = $('#item14').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate14').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst14').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst14').value = data1
                    }
                    document.getElementById('tigst14').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst14').value = data2

                }
            });

        });

        $(document).on('click', '#item15', function () {
            select = $('#item15').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate15').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst15').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst15').value = data1
                    }
                    document.getElementById('tigst15').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst15').value = data2

                }
            });

        });

        $(document).on('click', '#item16', function () {
            select = $('#item16').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate16').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst16').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst16').value = data1
                    }
                    document.getElementById('tigst16').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst16').value = data2

                }
            });

        });

        $(document).on('click', '#item17', function () {
            select = $('#item17').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate17').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst17').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst17').value = data1
                    }
                    document.getElementById('tigst17').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst17').value = data2

                }
            });

        });

        $(document).on('click', '#item18', function () {
            select = $('#item18').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate18').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst18').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst18').value = data1
                    }
                    document.getElementById('tigst18').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst18').value = data2

                }
            });

        });

        $(document).on('click', '#item19', function () {
            select = $('#item19').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate19').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst19').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst19').value = data1
                    }
                    document.getElementById('tigst19').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst19').value = data2

                }
            });

        });

        $(document).on('click', '#item20', function () {
            select = $('#item20').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate20').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst20').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst20').value = data1
                    }
                    document.getElementById('tigst20').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst20').value = data2

                }
            });

        });

        $(document).on('click', '#item21', function () {
            select = $('#item21').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('rate21').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst21').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst21').value = data1
                    }
                    document.getElementById('tigst21').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst21').value = data2

                }
            });

        });


    });
</script>

<!-- ..........................................TABLE 2  ITEM ............................................... -->


<script>
    $(document).ready(function () {
        var roinc = 0
        console.log("ajax");
        // var place = document.getElementById('pos').value;
        $(document).on('click', '#itemm1', function () {
            select = $('#itemm1').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee1').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst1').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst1').value = data1
                    }
                    document.getElementById('tigst1').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst1').value = data2
                }
            });
        });
        // console.log('pos:'+place_of_supply);
        $(document).on('click', '#itemm2', function () {
            select = $('#itemm2').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee2').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst2').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst2').value = data1
                    }
                    document.getElementById('tigst2').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst2').value = data2

                }
            });

        });

        $(document).on('click', '#itemm3', function () {
            select = $('#itemm3').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee3').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst3').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst3').value = data1
                    }
                    document.getElementById('tigst3').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst3').value = data2

                }
            });

        });

        $(document).on('click', '#itemm4', function () {
            select = $('#itemm4').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee4').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst4').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst4').value = data1
                    }
                    document.getElementById('tigst4').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst4').value = data2

                }
            });

        });

        $(document).on('click', '#itemm5', function () {
            select = $('#itemm5').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee5').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst5').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst5').value = data1
                    }
                    document.getElementById('tigst5').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst5').value = data2

                }
            });

        });

        $(document).on('click', '#itemm6', function () {
            select = $('#itemm6').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee6').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst6').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst6').value = data1
                    }
                    document.getElementById('tigst6').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst6').value = data2

                }
            });

        });

        $(document).on('click', '#itemm7', function () {
            select = $('#itemm7').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee7').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst7').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst7').value = data1
                    }
                    document.getElementById('tigst7').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst7').value = data2

                }
            });

        });

        $(document).on('click', '#itemm8', function () {
            select = $('#itemm8').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee8').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst8').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst8').value = data1
                    }
                    document.getElementById('tigst8').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst8').value = data2

                }
            });

        });

        $(document).on('click', '#itemm9', function () {
            select = $('#itemm9').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee9').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst9').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst9').value = data1
                    }
                    document.getElementById('tigst9').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst9').value = data2

                }
            });

        });

        $(document).on('click', '#itemm10', function () {
            select = $('#itemm10').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee10').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst10').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst10').value = data1
                    }
                    document.getElementById('tigst10').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst10').value = data2

                }
            });

        });

        $(document).on('click', '#itemm11', function () {
            select = $('#itemm11').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee11').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst11').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst11').value = data1
                    }
                    document.getElementById('tigst11').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst11').value = data2

                }
            });

        });

        $(document).on('click', '#itemm12', function () {
            select = $('#itemm12').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee12').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst12').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst12').value = data1
                    }
                    document.getElementById('tigst12').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst12').value = data2

                }
            });

        });

        $(document).on('click', '#itemm13', function () {
            select = $('#itemm13').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee13').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst13').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst13').value = data1
                    }
                    document.getElementById('tigst13').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst13').value = data2

                }
            });

        });

        $(document).on('click', '#itemm14', function () {
            select = $('#itemm14').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee14').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst14').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst14').value = data1
                    }
                    document.getElementById('tigst14').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst14').value = data2

                }
            });

        });

        $(document).on('click', '#itemm15', function () {
            select = $('#itemm15').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee15').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst15').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst15').value = data1
                    }
                    document.getElementById('tigst15').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst15').value = data2

                }
            });

        });

        $(document).on('click', '#itemm16', function () {
            select = $('#itemm16').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee16').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst16').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst16').value = data1
                    }
                    document.getElementById('tigst16').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst16').value = data2

                }
            });

        });

        $(document).on('click', '#itemm17', function () {
            select = $('#itemm17').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee17').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst17').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst17').value = data1
                    }
                    document.getElementById('tigst17').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst17').value = data2

                }
            });

        });

        $(document).on('click', '#itemm18', function () {
            select = $('#itemm18').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee18').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst18').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst18').value = data1
                    }
                    document.getElementById('tigst18').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst18').value = data2

                }
            });

        });

        $(document).on('click', '#itemm19', function () {
            select = $('#itemm19').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee19').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst19').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst19').value = data1
                    }
                    document.getElementById('tigst19').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst19').value = data2

                }
            });

        });

        $(document).on('click', '#itemm20', function () {
            select = $('#itemm20').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee20').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst20').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst20').value = data1
                    }
                    document.getElementById('tigst20').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst20').value = data2

                }
            });

        });

        $(document).on('click', '#itemm21', function () {
            select = $('#itemm21').val();
            customer = $('#customer_sel').val();
            console.log(select);
            console.log(customer);
            $.ajax({
                type: "GET",
                url: "{% url 'itemdata_challan' %}",
                data: {
                    id: select,
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.rate
                    data1 = response.gst
                    data2 = response.igst
                    data3 = response.pos
                    document.getElementById('ratee21').value = data

                    if (data3 == '{{ company.state }}') {
                        document.getElementById('tgst21').innerHTML = data1 + ' % GST';
                        document.getElementById('tgst21').value = data1
                    }
                    document.getElementById('tigst21').innerHTML = data2 + ' % IGST';
                    document.getElementById('tigst21').value = data2

                }
            });

        });


    });
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


{% endblock %}